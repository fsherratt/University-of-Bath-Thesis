\chapter{Conclusions and Further Work}
\label{chp:conclusions}
In this Chapter, the work conducted towards developing an \acrshort{ml} method for an activity classifier for an amputee to improve locomotion mode selection in the powered prosthesis is briefly discussed. This is followed by some suggestions for further work to continue this research.

\section{Conclusions} % Talk aims, implementation, achievements, limitations
An effort was made to contribute to the development of a locomotion mode classifier for amputees in the hope that this will be useful to the improvement of powered prosthetic devices. Specifically, the hypothesis stated in the Introductory Chapter was:

\textbf{A Machine Learning approach based on \acrfull{lstm} architecture can be used to predict gait modes with data requirements reduced through a transfer learning approach.}

A literature survey was conducted to establish the background around gait, lower limb powered prosthesis, and Machine Learning methods. The need for a system to identify an amputee's current locomotive intent to inform the selection of appropriate control modes was established. The current state of the art research has not demonstrated IMU-based ML classifiers applied to amputees; however, they have been applied to individuals without gait impairment. This appears to be partly due to the difficulties in collecting a large enough data set of amputee gait data. But also due to the highly individual nature of gait, especially for amputees. The need for further research in this area was established, especially for ways to reduce data requirements and increase performance.

In order to address these research gaps, a large set of gait data is required from non-amputees and amputees. As IMU gait data for lower limb amputees could not be found, a new data set is required. A novel system comprised of wireless \acrshort{imu}s and a companion smartphone app was developed to achieve this. This allowed for the unsupervised collection of labelled natural gait data from numerous individuals. Methods were developed for post-processing the gait data to prepare it for use in a TensorFlow ML environment. Work was also undertaken to develop the TensorFlow ML environment.

A journal article published in Sensors was presented that investigated the internal behaviour of an LSTM based LMR classifier. A public dataset of 22 individuals was collected using the previous Chapter's methodology. This data set was used to analyse the internal behaviour of a reduced complexity LSTM network. Experiments around analysing the network's hidden state were undertaken to establish a link between the input data and output classification. The analysis identifies that the model primarily classifies activity type based on data around early stance. Additional work was undertaken on a full LSTM LMR network to identify activity types for unseen novel subjects. Evaluation of generalisation for unseen subjects reveals low sensitivity to hyper-parameters with issues caused by over-fitting individuals' gait traits. Although an accuracy of greater than $95\%$ is possible for a seen individual classification, the network struggled to classify unseen individuals, achieving around $80\%$. Investigating the differences between individual subjects showed that gait variations between users primarily occur in early stance, potentially explaining the poor generalisation. Adjustment of hyper-parameters alone could not solve this, demonstrating the need for individual personalisation of models.

Based on the need for individual personalisation, methods for achieving this were investigated. A survey of literature revealed that transfer learning is a promising approach. However, its applicability to real-world data has not been investigated, nor has the requirements for the quantity of a target individual's data. Additional data for three subjects was collected using the previous methods developed. This allowed for an extensive study of the benefits of transfer learning with different quantities of target subject data. In order to use the unstructured real-world continuous data, new methods for data division were required. The data was poorly distributed, and therefore data rebalancing was required. This was accomplished by dividing the data into episodes, each containing a single continuous period of one activity. By combining episodes, a balanced data set could be constructed. This also had the benefit of allowing for multiple data sets to be systematically built and ensuring that the test data set was unseen.

A set of baselines were developed to compare the network's performance against. These were the best performance that could be achieved by either a general model built for other's data or a fully bespoke model constructed for a target subject's data. Two personalisation methods were attempted, data supplementation and transfer learning. Both methods improved the performance of the target subject's classification, achieving $90\%$ maximum. The maximum improvements were seen at low quantities of target data, demonstrating both methods showed promise for situations where only limited data is available.

Following the development of the personalisation methods, their applicability to amputees was evaluated. The literature found that studies had struggled to classify amputees using gait data from non-amputees. However, no study had attempted personalisation techniques using amputee data. There was also no investigation into differences in how the amputated and intact limbs would perform. Amputees have a very asymmetric gait; therefore, it should be expected that both legs would have different classification performances. A small set of amputee data was collected from a single trans-tibial amputee to investigate personalisation methods. Using the methodology previously discussed, personalisation experiments were repeated. The results showed a dramatic improvement in classification performance using limited amputee data. Both personalisation methods worked, achieving $90\%$ accuracy for the intact limb and just under $90\%$ for the amputated limb. Due to the limited data available for testing, it is not possible to say how generally these methods work, but they appear promising and should be investigated further.

This work has raised many additional research questions. Such as the applicable of the amputee personalisation result to people with other gait abnormalities. There is future research in to the use of an amputees intact limb classifier to improve gait classification. These form areas that could be focus of future research.

The work allows for large scale collection of gait data that is free from laboratory constraints while reducing gait bias from researchers. The work also highlighted the improvements in classification performance that can be achieved by using a general population as a starting point for building a bespoke classifier. Initial work indicates that this is highly applicable to classifying individual with gait abnormalities. Further work is still required to see how generally applicable this is to amputees and other gait abnormalities.

\section{Further Work} % One Step Beyond
The work conducted has demonstrated that this is an area of research with promise. However, there are numerous aspects where additional research could yield improvements. These include:

\begin{itemize}
    \item Additional amputees --  The trial only included a single trans-tibial amputee. Additional amputee trials should involve multiple subjects, including amputees of different weights, heights, and levels of amputation in multiple environments to test the applicability more generally.
    
    \item Investigate how the transition will affect performance -- Due to the data division scheme employed for the personality study, the transition between activities was not considered. In Chapter \ref{chp:lstm-general} transition was identified as a key area of error. Looking at how classification performance changes around this area would inform knowledge of the current performance of the model during transition. Changes to the labelling of transitions, \acrshort{ml} model architecture, and model hyper-parameters should then be investigated to see if transition performance can be improved.
    
    \item A greater number of environments -- It was hypothesised that the addition of new environments affects performance; however, due to the limited data labelling, it was not possible to investigate this. Modifying the app to store location data would allow for greater detail to be understood about the environment. By using map data the type of environment could be automatically tagged. Classification performance could then be filtered to see how performance changes based on different environments.
    
    \item Investigate more complex LMR networks -- A very shallow LSTM network was investigated. This was selected due to its adequate performance and ability to iterate quickly with a shallow network. Other work has successfully used deeper and more sophisticated networks; this should be explored further. There is also a large scope for hyper-parameter optimisation as only a little work was performed in this area.
    
    \item Implementation for real-time -- The fact that the system works on a smartphone means that a system could be deployed in the real world for more extensive testing. Direct real-time feedback on the models performance could be used to inform a semi-supervised learning system. This would allow for far greater data quantities to be used during training without the need for direct user labelling.
\end{itemize}

